#
# WTL 7.1 Support
#
!IF "$(USE_WTL)" == "1"
! IF "$(WTL_VER)" == "71"
WTL_INC_PATH=$(WTL71_INC_PATH)
! ENDIF
!ENDIF

#
# ATL 7.1 Support
#
!IF "$(USE_ATL)" == "1" || "$(USE_STATIC_ATL)" == "1"
! IF "$(ATL_VER)" == "71"

ATL_INC_PATH=$(ATL71_INC_PATH)
ATL_LIB_PATH=$(ATL71_LIB_PATH)

ATL_INCLUDES=$(ATL71_INC_PATH)\atl71

!IFDEF USE_STATIC_ATL
!IFDEF USE_ATL
!ERROR USE_ATL and USE_STATIC_ATL is mutually exclusive. Define only once!
!ENDIF
!ENDIF

!IFNDEF DATL
!IF $(FREEBUILD)
DATL=
!ELSE
DATL=d
!ENDIF
!ENDIF

#
# _ATL_NO_DEFAULT_LIBS discard lines #pragma comment(lib, "user32.lib"), etc.
# As we're already using the /NODEFAULTLIB linker option,
# We can safely ignore these pragmas.
# 
C_DEFINES=$(C_DEFINES) /D_ATL_NO_DEFAULT_LIBS
#
# ATL 71 requires atls.lib even if ATL DLL is used
#
TARGETLIBS=$(TARGETLIBS) $(ATL_LIB_PATH)\atls$(DATL).lib

#
# Static linking of the Registrar's parser adds approximately 
# 5K to a release build.
#
!IFDEF USE_STATIC_ATL
!UNDEF USE_STATIC_ATL
C_DEFINES=$(C_DEFINES) /D_ATL_STATIC_REGISTRY
!ENDIF

!IFDEF USE_ATL
!UNDEF USE_ATL
C_DEFINES=$(C_DEFINES) /D_ATL_DLL
TARGETLIBS=$(TARGETLIBS) $(ATL_LIB_PATH)\atl.lib
!ENDIF

!IFDEF ATL_MIN_CRT
C_DEFINES=$(C_DEFINES) /D_ATL_MIN_CRT
TARGETLIBS=$(TARGETLIBS) $(ATL_LIB_PATH)\atlmincrt.lib
!ENDIF

!IFDEF ATL_ATTRIBUTES
C_DEFINES=$(C_DEFINES) /D_ATL_ATTRIBUTES
!ENDIF

# ATL 7.1 requires VC7_SYMBOLS
VC7_SYMBOLS=1

# ATL 7.1 requires DEPRECIATE_DEFAULT_MFC_INCLUDE
DEPRECIATE_DEFAULT_MFC_INCLUDE=1

! ENDIF
!ENDIF

#
# CRT 7.1 Support
#
!IF "$(CRT_VER)"=="71"

CRT_INC_PATH=$(CRT71_INC_PATH)
CRT_LIB_PATH=$(CRT71_LIB_PATH)

# CRT 7.1 requires VC7_SYMBOLS
VC7_SYMBOLS=1

# CRT 7.1 requires DEPRECIATE_DEFAULT_MFC_INCLUDE
DEPRECIATE_DEFAULT_MFC_INCLUDE=1

!ENDIF

#
# Platform SDK Support
#
!IF "$(USE_PLATFORM_SDK)"=="1"

SDK_INC_PATH=$(PSDK_INC_PATH)
SDK_LIB_PATH=$(PSDK_LIB_PATH)

# PLATFORM SDK requires DEPRECIATE_DEFAULT_MFC_INCLUDE
DEPRECIATE_DEFAULT_MFC_INCLUDE=1

USE_LOCAL_HOTPATCHBUFFER=1

!ENDIF

#
# Depreciate default MFC
#
!IF "$(DEPRECIATE_DEFAULT_MFC_INCLUDE)" == "1"
MFC_INCLUDES=
OAK_INC_PATH=
!ENDIF
